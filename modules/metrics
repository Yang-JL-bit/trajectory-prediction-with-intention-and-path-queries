def cal_intention_acc(pred, label):
    pred = torch.argmax(pred, dim=-1)
    acc = torch.sum(pred == label) / len(pred)
    return acc

def cal_traj_acc(traj_score_pred, candidate_traj,  traj_gt, candidate_traj_mask):
    traj_distances = torch.norm(candidate_traj - traj_gt.unsqueeze(1), dim=-1).sum(dim=-1)  # 路径上所有点的 L2 距离
    # 找到最接近真实轨迹的轨迹索引
    closest_traj_idx = torch.argmin(traj_distances + (1 - candidate_traj_mask) * 1e6, dim=1)
    traj_score_pred = traj_score_pred + (candidate_traj_mask - 1)  * 1e9
    traj_score_pred_idx = torch.argmax(traj_score_pred, dim=-1)
    # print("label: ", closest_traj_idx)
    # print("pred: ", traj_score_pred_idx)
    acc = torch.sum(traj_score_pred_idx == closest_traj_idx) / len(closest_traj_idx)
    return acc